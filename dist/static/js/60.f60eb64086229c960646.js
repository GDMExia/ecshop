webpackJsonp([60],{"2Uhl":function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("woOf"),i=n.n(o),s=n("Dd8w"),a=n.n(s),c=(n("vAZe"),n("A4kR")),r=n("Au9i"),u=n("NYxO"),h=n("erh5"),f=n("RuWt"),g=(n("mtWM"),n("vMJZ")),l={name:"Signin",data:function(){return{username:"",password:""}},computed:a()({},Object(u.e)({config:function(t){return t.config.config},feature:function(t){return t.config.feature},flag:function(t){return t.auth.flag}}),{isShowWechat:function(){return!!(this.config&&this.config["wechat.web"]&&this.wxApi.isweixin())},isShowAuth:function(){return!!this.isShowWechat}}),created:function(){this.fetchConfig()},mounted:function(){this.getToken()},methods:a()({},Object(u.d)({saveAuthInfo:"signin",saveToken:"saveToken",saveUser:"saveUser",changeFlag:"changeFlag"}),Object(u.b)({fetchConfig:"fetchConfig"}),{signin:function(){var t=this,e=this.username,n=this.password;0!==e.length?0!==n.length?n.length<6?Object(r.Toast)("至少输入6位密码"):(r.Indicator.open(),c.a(e,n).then(function(e){r.Indicator.close(),t.saveAuthInfo({token:e.token,user:e.user}),t.goHome()},function(t){r.Indicator.close(),Object(r.Toast)(t.errorMsg)})):Object(r.Toast)("请输入密码"):Object(r.Toast)("请输入用户名/邮箱/手机号")},goBack:function(){var t=this.$route.params.isFromInfoEdit,e=this.$route.params.isFromShare;t||e?this.$router.push("home"):this.$router.go(-1)},goHome:function(){this.$router.push("/home")},onSignup:function(){this.$router.push({name:"signup"})},onRetrieve:function(){this.$router.push({name:"retrieve"})},onWechat:function(){this.wxWebAuth()},getAuthSocial:function(){var t,e,n,o,s,a=this;Object(h.a)("/v2/ecapi.auth.social","POST",{vendor:t,access_token:e,open_id:n,invite_code:o,js_code:s}).then(function(t){t&&(a.authSocial=i()([],a.authSocial))})},wxWebAuth:function(){this.changeFlag(!0);var t=this.$cookie.get("r"),e=encodeURIComponent(window.location.protocol+"//"+window.location.host);t?(env.API_HOST,f.a.SOCIAL_VENDOR.WEIXIN):(env.API_HOST,f.a.SOCIAL_VENDOR.WEIXIN)},onAuthSuccess:function(){var t=this,e=this.$cookie.get("o"),n=this.$cookie.get("t");e&&n&&(r.Indicator.open(),this.saveToken({token:n}),Object(g.c)().then(function(e){r.Indicator.close(),console.log(e),e&&e.user&&(e.user.mobile_binded?(t.saveToken({token:n}),t.goHome()):t.goBind())},function(t){console.log(t),Object(r.Toast)(t.errorMsg),r.Indicator.close()}))},goBind:function(){this.$router.push({name:"bind"})},getToken:function(){var t=this,e=this.$store.state.auth.infoToken;if(e){console.log(e);var n=new FormData;n.append("token",e),this.$http.post("http://xgguc.suoqoo.com/index.php/Index/getUserInfo",n).then(function(e){console.log(e.data.accountInfo),t.username=e.data.accountInfo.email,t.password=e.data.accountInfo.password,t.signin()})}}})},d={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"container"},[e("mt-header",{staticClass:"header",attrs:{fixed:"",title:"登录"}},[e("header-item",{attrs:{slot:"left",isBack:!0},on:{onclick:this.goBack},slot:"left"}),this._v(" "),e("header-item",{attrs:{slot:"right",title:""},on:{onclick:this.onSignup},slot:"right"})],1)],1)},staticRenderFns:[]};var p=n("VU/8")(l,d,!1,function(t){n("3nNV")},"data-v-1ecf3429",null);e.default=p.exports},"3nNV":function(t,e){}});
//# sourceMappingURL=60.f60eb64086229c960646.js.map