{"version":3,"sources":["webpack:///src/page/auth/Signin.vue","webpack:///./src/api/auth-social.js","webpack:///./src/page/auth/Signin.vue?8e5e","webpack:///./src/page/auth/Signin.vue"],"names":["Signin","computed","extends_default","Object","vuex_esm","config","feature","flag","fetchConfig","getToken","methods","_this","this","username","password","open","then","response","close","user","goHome","error","errorMsg","isFromInfoEdit","isFromShare","wxWebAuth","vendor","access_token","open_id","invite_code","js_code","_this2","network","authSocial","encodeURIComponent","window","location","protocol","host","env","API_HOST","const_enum","SOCIAL_VENDOR","WEIXIN","_this3","token","goBind","_this4","infoToken","FormData","accountInfo","email","signin","auth_Signin","render","_h","$createElement","_c","_self","staticClass","attrs","fixed","title","slot","isBack","on","onclick","goBack","_v","onSignup","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"sPAwEAA,QAEA,yCAGA,YAEA,KAGAC,SAAAC,OAAAC,OAAAC,EAAA,EAAAD,qCAEAE,4CACAC,wCAEAC,qLAeAC,uCAOAC,YAMAC,QAAAR,OAAAC,OAAAC,EAAA,EAAAD,eAEA,mBACA,qBACA,sBAGA,eANAA,OAAAC,EAAA,EAAAD,cASA,mCACA,IAAAQ,EAAAC,YACAC,gBACAC,8DAWA,yBAGAC,gBACAC,KAAA,SAAAC,eAEAC,6CACAC,SACAC,UACA,SAAAC,eAEAH,0BACAI,6BAhBA,yBALA,6DA2BAC,oCACAC,mCAEA,yBAEA,wCAKA,sDAIA,0DAIA,uCAIAC,sCAIA,ICnLCC,EACAC,EACAC,EACAC,EACAC,ED+KDC,EAAAnB,KC7KCT,OAAA6B,EAAA,EAAA7B,CAAc,wBAAyB,QACtCuB,OAAQA,EACRC,aAAcA,EACdC,QAASA,EACTC,YAAaA,EACbC,QAASA,+CD2KXG,sDAMA,iCAGAC,mBAAAC,OAAAC,SAAAC,SAAA,KAAAF,OAAAC,SAEAE,SAGAC,IACAC,SACAC,EAAA,EAAAC,cACAC,SAQAJ,IACAC,SACAC,EAAA,EAAAC,cACAC,kCAUA,IAAAC,EAAAhC,wBACA,wBACA,wBAEAG,6BACA8B,kBACA7B,KAAA,SAAAC,eAEAC,oBACAD,wDAGA4B,MACAzB,YAEA0B,WAGA,SAAAzB,eAEAA,qBACAC,sBACAJ,sDAOA,8BAGA,IAAA6B,EAAAnC,8BAEAoC,eACA,aAEAA,aACAC,0BACAD,gHAMAE,2CAEAC,oCACArC,WACAsC,gBE9QAC,GADiBC,OAFjB,WAA0B,IAAaC,EAAb3C,KAAa4C,eAA0BC,EAAvC7C,KAAuC8C,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAiBE,YAAA,cAAwBF,EAAA,aAAkBE,YAAA,SAAAC,OAA4BC,MAAA,GAAAC,MAAA,QAAyBL,EAAA,eAAoBG,OAAOG,KAAA,OAAAC,QAAA,GAA4BC,IAAKC,QAA3OtD,KAA2OuD,QAAqBJ,KAAA,SAAhQnD,KAA6QwD,GAAA,KAAAX,EAAA,eAAgCG,OAAOG,KAAA,QAAAD,MAAA,IAA0BG,IAAKC,QAAnVtD,KAAmVyD,UAAuBN,KAAA,WAAc,QAEjYO,oBCCjB,IAcAC,EAdAC,EAAA,OAcAC,CACAzE,EACAqD,GATA,EAVA,SAAAqB,GACAF,EAAA,SAaA,kBAEA,MAUAG,EAAA,QAAAJ,EAAA","file":"static/js/60.f60eb64086229c960646.js","sourcesContent":["<template>\n\t<div class=\"container\">\n\t\t<mt-header class=\"header\" fixed title=\"登录\">\n\t\t\t<header-item\n\t\t\t\tslot=\"left\"\n\t\t\t\tv-bind:isBack=\"true\"\n\t\t\t\tv-on:onclick=\"goBack\"\n\t\t\t></header-item>\n\t\t\t<header-item\n\t\t\t\tslot=\"right\"\n\t\t\t\ttitle=\"\"\n\t\t\t\tv-on:onclick=\"onSignup\"\n\t\t\t></header-item>\n\t\t</mt-header>\n<!--\t\t<div class=\"top-wrapper\">-->\n<!--\t\t\t<div class=\"input-wrapper\">-->\n<!--\t\t\t\t<img src=\"../../assets/image/change-icon/a0_user@2x.png\" />-->\n<!--\t\t\t\t<input-->\n<!--\t\t\t\t\tv-model=\"username\"-->\n<!--\t\t\t\t\tplaceholder=\"用户名/邮箱/手机号\"-->\n<!--\t\t\t\t\ttype=\"text\"-->\n<!--\t\t\t\t/>-->\n<!--\t\t\t</div>-->\n<!--\t\t\t<div class=\"input-wrapper\">-->\n<!--\t\t\t\t<img src=\"../../assets/image/change-icon/a0_key@2x.png\" />-->\n<!--\t\t\t\t<input-->\n<!--\t\t\t\t\ttype=\"password\"-->\n<!--\t\t\t\t\tclass=\"bottom-input\"-->\n<!--\t\t\t\t\tv-model=\"password\"-->\n<!--\t\t\t\t\tplaceholder=\"请输入密码\"-->\n<!--\t\t\t\t\tmaxlength=\"20\"-->\n<!--\t\t\t\t/>-->\n<!--\t\t\t</div>-->\n<!--\t\t</div>-->\n<!--\t\t<gk-button type=\"primary\" class=\"button\" v-on:click=\"signin\"-->\n<!--\t\t\t>登录</gk-button-->\n<!--\t\t>-->\n<!--\t\t<div class=\"retrieve-wrapper\">-->\n<!--\t\t\t<div class=\"retrieve-item\" @click=\"onRetrieve\">-->\n<!--\t\t\t\t<label id=\"retrieve-title\">忘记密码？</label>-->\n<!--\t\t\t</div>-->\n<!--\t\t</div>-->\n<!--\t\t<div class=\"bottom-wrapper\" v-if=\"isShowAuth\">-->\n<!--\t\t\t<div class=\"auth-title-wrapper\">-->\n<!--\t\t\t\t<div class=\"auth-line\"></div>-->\n<!--\t\t\t\t<label class=\"auth-title\">第三方登录</label>-->\n<!--\t\t\t\t<div class=\"auth-line\"></div>-->\n<!--\t\t\t</div>-->\n<!--\t\t\t<div class=\"auth-bottom-wrapper\">-->\n<!--\t\t\t\t<div class=\"auth-item\" v-if=\"isShowWechat\" @click=\"onWechat\">-->\n<!--\t\t\t\t\t<img-->\n<!--\t\t\t\t\t\tclass=\"auth-item-icon\"-->\n<!--\t\t\t\t\t\tsrc=\"../../assets/image/change-icon/c7_commodity_list_2@2x.png\"-->\n<!--\t\t\t\t\t/>-->\n<!--\t\t\t\t\t<label class=\"auth-title auth-item-title\">微信</label>-->\n<!--\t\t\t\t</div>-->\n<!--\t\t\t</div>-->\n<!--\t\t</div>-->\n\t</div>\n</template>\n\n<script>\nimport { HeaderItem, Button } from '../../components/common'\nimport * as authBase from '../../api/auth-base'\nimport { Indicator, Toast, Header } from 'mint-ui'\nimport { mapMutations, mapActions, mapState } from 'vuex'\nimport { authSocial } from '../../api/auth-social'\nimport { authWeb } from '../../api/auth-web'\nimport { ENUM } from '../../const/enum'\nimport axios from 'axios'\n// import { GLOBAL_CONFIG } from '../../config/config.app'\nimport { userProfileGet } from '../../api/user'\nexport default {\n\tname: 'Signin',\n\tdata() {\n\t\treturn {\n\t\t\tusername: '',\n\t\t\tpassword: ''\n\t\t}\n\t},\n\n\tcomputed: {\n\t\t...mapState({\n\t\t\tconfig: state => state.config.config,\n\t\t\tfeature: state => state.config.feature,\n\t\t\tflag: state => state.auth.flag\n\t\t}),\n\t\tisShowWechat: function() {\n\t\t\tif (this.config && this.config['wechat.web'] && this.wxApi.isweixin()) {\n\t\t\t\treturn true\n\t\t\t}\n\t\t\treturn false\n\t\t},\n\t\tisShowAuth: function() {\n\t\t\tif (this.isShowWechat) {\n\t\t\t\treturn true\n\t\t\t}\n\t\t\treturn false\n\t\t}\n\t},\n\tcreated: function() {\n\t\tthis.fetchConfig()\n\t},\n\tmounted() {\n\t\t// let isTokenInvalid = this.$route.params.isTokenInvalid\n\t\t// if (isTokenInvalid) {\n\t\t// \tToast('登录过期')\n\t\t// }\n\t  this.getToken()\n\t\t// if (this.flag) {\n\t\t//   this.onAuthSuccess();\n\t\t//   this.changeFlag(false);\n\t\t// }\n\t},\n\tmethods: {\n\t\t...mapMutations({\n\t\t\tsaveAuthInfo: 'signin',\n\t\t\tsaveToken: 'saveToken',\n\t\t\tsaveUser: 'saveUser',\n\t\t\tchangeFlag: 'changeFlag'\n\t\t}),\n\n\t\t...mapActions({\n\t\t\tfetchConfig: 'fetchConfig'\n\t\t}),\n\t\tsignin() {\n\t\t\tlet username = this.username\n\t\t\tlet password = this.password\n\t\t\tif (username.length === 0) {\n\t\t\t\tToast('请输入用户名/邮箱/手机号')\n\t\t\t\treturn\n\t\t\t}\n\t\t\t// TODO: 用户名（为手机号或邮箱）校验\n\t\t\tif (password.length === 0) {\n\t\t\t\tToast('请输入密码')\n\t\t\t\treturn\n\t\t\t}\n\t\t\tif (password.length < 6) {\n\t\t\t\tToast('至少输入6位密码')\n\t\t\t\treturn\n\t\t\t}\n\t\t\tIndicator.open()\n\t\t\tauthBase.authSignin(username, password).then(\n\t\t\t\tresponse => {\n\t\t\t\t\tIndicator.close()\n\t\t\t\t\tthis.saveAuthInfo({ token: response.token, user: response.user })\n\t\t\t\t\tthis.goHome()\n\t\t\t\t},\n\t\t\t\terror => {\n\t\t\t\t\tIndicator.close()\n\t\t\t\t\tToast(error.errorMsg)\n\t\t\t\t}\n\t\t\t)\n\t\t},\n\n\t\tgoBack() {\n\t\t\tlet isFromInfoEdit = this.$route.params.isFromInfoEdit\n\t\t\tlet isFromShare = this.$route.params.isFromShare\n\t\t\tif (isFromInfoEdit || isFromShare) {\n\t\t\t\tthis.$router.push('home')\n\t\t\t} else {\n\t\t\t\tthis.$router.go(-1)\n\t\t\t}\n\t\t},\n\n\t\tgoHome() {\n\t\t\tthis.$router.push('/home')\n\t\t},\n\n\t\tonSignup() {\n\t\t\tthis.$router.push({ name: 'signup' })\n\t\t},\n\n\t\tonRetrieve() {\n\t\t\tthis.$router.push({ name: 'retrieve' })\n\t\t},\n\n\t\tonWechat() {\n\t\t\tthis.wxWebAuth()\n\t\t},\n\n\t\t// 获取第三方授权登录数据\n\t\tgetAuthSocial() {\n\t\t\tauthSocial().then(res => {\n\t\t\t\tif (res) {\n\t\t\t\t\tthis.authSocial = Object.assign([], this.authSocial)\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\n\t\twxWebAuth() {\n\t\t\tthis.changeFlag(true)\n\t\t\tlet invite_code = this.$cookie.get('r') // 获取邀请人id\n\t\t\tlet scope = 'snsapi_userinfo' // 允许获取用户信息\n\t\t\tlet ref = encodeURIComponent(\n\t\t\t\twindow.location.protocol + '//' + window.location.host\n\t\t\t)\n\t\t\tlet locationRef = ''\n\t\t\tif (invite_code) {\n\t\t\t\tlocationRef =\n\t\t\t\t\tenv.API_HOST +\n\t\t\t\t\t'/v2/ecapi.auth.web?vendor=' +\n\t\t\t\t\tENUM.SOCIAL_VENDOR.WEIXIN +\n\t\t\t\t\t'&scope=' +\n\t\t\t\t\tscope +\n\t\t\t\t\t'&referer=' +\n\t\t\t\t\tref +\n\t\t\t\t\t'&invite_code=' +\n\t\t\t\t\tinvite_code\n\t\t\t} else {\n\t\t\t\tlocationRef =\n\t\t\t\t\tenv.API_HOST +\n\t\t\t\t\t'/v2/ecapi.auth.web?vendor=' +\n\t\t\t\t\tENUM.SOCIAL_VENDOR.WEIXIN +\n\t\t\t\t\t'&scope=' +\n\t\t\t\t\tscope +\n\t\t\t\t\t'&referer=' +\n\t\t\t\t\tref\n\t\t\t}\n\n\t\t\t// window.location.href = locationRef\n\t\t},\n\n\t\tonAuthSuccess() {\n\t\t\tlet openid = this.$cookie.get('o')\n\t\t\tlet token = this.$cookie.get('t')\n\t\t\tif (openid && token) {\n\t\t\t\tIndicator.open()\n\t\t\t\tthis.saveToken({ token: token })\n\t\t\t\tuserProfileGet().then(\n\t\t\t\t\tresponse => {\n\t\t\t\t\t\tIndicator.close()\n\t\t\t\t\t\tconsole.log(response)\n\t\t\t\t\t\tif (response && response.user) {\n\t\t\t\t\t\t\tif (response.user.mobile_binded) {\n\t\t\t\t\t\t\t\tthis.saveToken({ token: token })\n\t\t\t\t\t\t\t\tthis.goHome()\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis.goBind()\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\terror => {\n\t\t\t\t\t\tconsole.log(error)\n\t\t\t\t\t\tToast(error.errorMsg)\n\t\t\t\t\t\tIndicator.close()\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t}\n\t\t},\n\n\t\tgoBind() {\n\t\t\tthis.$router.push({ name: 'bind' })\n\t\t},\n\n\t  \tgetToken () {\n\t\t  // alert(111)\n          let infoToken=this.$store.state.auth.infoToken\n\t\t  if (infoToken) {\n            // Indicator.open()\n\t\t\tconsole.log(infoToken)\n\t\t\tlet data=new FormData()\n\t\t\tdata.append('token', infoToken)\n            // authBase.getauthInfo(data).then(res => {\n            //\n\t\t\t//   }\n            // )\n\t\t\tthis.$http.post('http://xgguc.suoqoo.com/index.php/Index/getUserInfo',data).then(res=>{\n\t\t\t  console.log(res.data.accountInfo)\n\t\t\t\t// res.body.accountInfo\n              this.username=res.data.accountInfo.email\n              this.password=res.data.accountInfo.password\n              this.signin()\n\t\t\t})\n            // axios.request({\n            //   url: 'http://xgguc.suoqoo.com/index.php/Index/getUserInfo',\n            //   data: data,\n            //   method: 'post'\n            // }).then(res=>{\n            //   console.log(res)\n\t\t\t// })\n\t\t  }\n\t\t}\n\t}\n}\n</script>\n\n<style scoped lang=\"scss\">\n.container {\n\tflex: 1;\n\tdisplay: flex;\n\tflex-direction: column;\n\tjustify-content: flex-start;\n\talign-items: stretch;\n\tbackground-color: $mainbgColor;\n\t.top-wrapper {\n\t\tmargin-top: 54px;\n\t\t.input-wrapper {\n\t\t\tdisplay: flex;\n\t\t\talign-content: center;\n\t\t\talign-items: center;\n\t\t\tpadding-left: 10px;\n\t\t\tbackground-color: #fff;\n\t\t\theight: 44px;\n\t\t\timg {\n\t\t\t\twidth: 24px;\n\t\t\t\theight: 24px;\n\t\t\t\tmargin: 0px;\n\t\t\t\tpadding: 0px;\n\t\t\t}\n\t\t\tinput {\n\t\t\t\t@include input;\n\t\t\t\tflex: 1;\n\t\t\t}\n\t\t\t.bottom-input {\n\t\t\t\tborder-bottom-width: 0px;\n\t\t\t}\n\t\t}\n\t}\n}\n.header {\n\t@include header;\n}\n.button {\n\t@include button;\n\tmargin-top: 40px;\n}\n.retrieve-wrapper {\n\theight: 40px;\n\tmargin-top: 10px;\n\tdisplay: flex;\n\tflex-direction: row;\n\tjustify-content: flex-end;\n}\n.retrieve-item {\n\twidth: 80px;\n\theight: 40px;\n\tmargin-right: 10px;\n\tdisplay: flex;\n\tjustify-content: center;\n\talign-items: center;\n}\n#retrieve-title {\n\tcolor: $primaryColor;\n\tfont-size: 15px;\n\ttext-align: center;\n}\n.bottom-wrapper {\n\tdisplay: flex;\n\tflex: 1;\n\tflex-direction: column;\n\tjustify-content: flex-end;\n\talign-items: stretch;\n}\n.auth-wrapper {\n\tdisplay: flex;\n\tflex-direction: column;\n\tjustify-content: flex-start;\n\talign-items: center;\n\theight: 260px;\n}\n.auth-title-wrapper {\n\theight: 20px;\n\tdisplay: flex;\n\tflex-direction: row;\n\tjustify-content: flex-start;\n\talign-items: center;\n\tmargin-bottom: 40px;\n}\n.auth-title {\n\tcolor: #8f8e94;\n\tfont-size: 14px;\n}\n.auth-line {\n\tdisplay: flex;\n\tflex: 1;\n\theight: 1px;\n\tbackground-color: #d8d8d8;\n\tmargin-left: 16px;\n\tmargin-right: 16px;\n}\n.auth-item {\n\tdisplay: flex;\n\tflex-direction: column;\n\tjustify-content: flex-start;\n\talign-items: center;\n}\n.auth-item-icon {\n\twidth: 60px;\n\theight: 60px;\n}\n.auth-item-title {\n\tmargin-top: 12px;\n}\n.auth-bottom-wrapper {\n\tdisplay: flex;\n\tflex-direction: row;\n\tjustify-content: space-around;\n\talign-items: center;\n\tmargin-left: 15px;\n\tmargin-right: 15px;\n\tmargin-bottom: 20px;\n}\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/page/auth/Signin.vue","import { fetchEndpoint } from '../server/network'\n\n// 第三方授权\nexport const authSocial = (\n\tvendor,\n\taccess_token,\n\topen_id,\n\tinvite_code,\n\tjs_code\n) =>\n\tfetchEndpoint('/v2/ecapi.auth.social', 'POST', {\n\t\tvendor: vendor, // 第三方平台类型\n\t\taccess_token: access_token, // OAUTH TOKEN\n\t\topen_id: open_id, // 用户ID\n\t\tinvite_code: invite_code, // 推荐人ID（选填）\n\t\tjs_code: js_code // 小程序专用（选填）\n\t})\n\n\n\n// WEBPACK FOOTER //\n// ./src/api/auth-social.js","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container\"},[_c('mt-header',{staticClass:\"header\",attrs:{\"fixed\":\"\",\"title\":\"登录\"}},[_c('header-item',{attrs:{\"slot\":\"left\",\"isBack\":true},on:{\"onclick\":_vm.goBack},slot:\"left\"}),_vm._v(\" \"),_c('header-item',{attrs:{\"slot\":\"right\",\"title\":\"\"},on:{\"onclick\":_vm.onSignup},slot:\"right\"})],1)],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-1ecf3429\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/page/auth/Signin.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true,\\\"publicPath\\\":\\\"../../\\\"}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-1ecf3429\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!sass-loader?{\\\"sourceMap\\\":true}!sass-resources-loader?{\\\"resources\\\":[\\\"/Users/fangweihao/Desktop/programme/other/ecshop-h5源码v2.1.2/src/assets/style/_variable.scss\\\",\\\"/Users/fangweihao/Desktop/programme/other/ecshop-h5源码v2.1.2/src/assets/style/mixin.scss\\\",\\\"/Users/fangweihao/Desktop/programme/other/ecshop-h5源码v2.1.2/src/components/style/var.scss\\\"]}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./Signin.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./Signin.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./Signin.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-1ecf3429\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./Signin.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-1ecf3429\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/page/auth/Signin.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}